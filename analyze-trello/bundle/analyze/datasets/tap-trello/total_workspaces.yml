version: datasets/v0.2
source: trello
title: total workspaces
question: how many workspaces in a trello account
description: |-
  This couns the number of workspaces in a trello account
  
visualisation: |-
  {"chartjs-chart": 
    {"chartType": "bar", 
      "options": {
        "scales": {
          "yAxes": [{
            "ticks": {
              "beginAtZero": true
            }
          }]
        }
      }
    }
  }
  
query: |-

with trello_board as (  

select name, idOrganization from {{ ref('trello_boards') }}  where name = {{ board_name }}

),   

org as (

   select displayName as workspace_name, id as org_id from {{ ref(trello_org) }} 

 ),   


workspace_agg as (

SELECT  trello_board.name, trello_board.idOrganization, org.workspace_name, org.org_id
FROM trello_board, org
WHERE trello_board.idOrganization = org.org_id 
AND trello_board.idOrganization = {{ id_org }} 

)   


SELECT COUNT(workspace_name) AS count_workspace FROM workspace_agg WHERE org_id = {{ id_org }} 

